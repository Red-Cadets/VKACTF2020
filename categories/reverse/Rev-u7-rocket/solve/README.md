# Как тебе такое, Илон Маск?


|   Событие    |          Название          |      Категория      | Сложность |
| :----------: | :------------------------: | :-----------------: | :-------: |
| VKA-CTF`2020 | Как тебе такое, Илон Маск? | Обратная разработка |  Выпуск   |

## Описание

> Автор: Rex
>
> ![KMO_120232_22137_1_t218_141806](KMO_120232_22137_1_t218_141806.jpg)
>
> Чтобы дать отпор Илону нам пришлось очень быстро готовить к запуску новую ракету, даже разукрасить не успели. Хотя проблема не в этом...Может разберешься почему она не может взлететь?

## Решение

Судя по таблице импорта мы имеем дело с **Directx 11**

![Capture18](Capture18.PNG)

Попробуем воспользоваться графическим отладчик для D3D11 - RenderDoc

![Capture1](Capture1.PNG)

![Capture16](Capture16.PNG)

![Capture17](Capture17.PNG)

Ни одна из частей ракеты не является флагом, он не передается на отрисовку - будем иметь в виду.

Посмотрим где хранится модель ракеты

Поиск binwalk  и тд не дадут результатов, модель сжата

![image-20200626205241462](Capture2.PNG)

После decompress делаем поиск по строкам и находим наш формат хранения модели - **gltf**

![Capture13](Capture13.PNG)

Формат заголовка следующий

![Capture3](Capture3.png)

Размер файла 0x165FE10

Сдампим файл для анализа
```
auto fname, address, size;
address = 0x1E363564040;
size = 0x165FE10;
fname = "C:\\path\\to\\file\\bin.dump";
auto file= fopen(fname, "wb");
savefile(file, 0, address, size);
fclose(file);
```
Меняем разрешение файла на **gltf**, загружаем в  **Blender** и лицезреем нашу модель

![Capture14](Capture14.PNG)

Просмотрев каждый объект, наше внимание может привлечь **Camera.002** (у нее **scale** = 0 и при отображении ее не будет видно)

Поставив масштаб X, Y, Z  больше нуля, видим наш флаг

![Capture15](Capture15.PNG)

Сдаем флаг

> VKACTF{y0u_f1nd_m3}
